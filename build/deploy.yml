AWSTemplateFormatVersion: '2010-09-09'
Description: >
  Create an IAM role to use for code build for serverless builds

Parameters:
  ArtifactBucket:
    Type: String
    Description: Bucket name in which to store the artifacts
  CodeBuildRoleId:
    Type: String
    Description: Build role

Resources:
  CodeBuildProject:
    Type: AWS::CodeBuild::Project
    Properties:
      Name: apiGWSampleDeploy
      Description: build project (and ci skeleton) for gw sample
      ServiceRole: !Join [ "", ["arn:aws:iam::", !Ref "AWS::AccountId", ":role/", !Ref "CodeBuildRoleId" ]]
      Environment:
        Type: LINUX_CONTAINER
        ComputeType: BUILD_GENERAL1_SMALL
        Image: aws/codebuild/eb-nodejs-6.10.0-amazonlinux-64:4.0.0
      Source:
        Type: CODEPIPELINE
        BuildSpec: deployspec.yml
      Artifacts:
        Type: CODEPIPELINE
      TimeoutInMinutes: 10
